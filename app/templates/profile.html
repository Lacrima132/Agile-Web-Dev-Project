{% extends "base.html" %}
{% block title %}{{ user.username }}{% endblock %}
{% block content %}
<div class="intro-section">
  <div>
    <div class="info-bubble">
      <div class="profile-pic">
        <img src="{{ url_for('static', filename='images/profilepics/' + user.avatar) }}" class="avatar" alt="avatar">
      </div>
      <div class="profile-box2">
        <div class="profile-box3">
          <h2 class="profile-name">
            {{ user.username }}
            <img src="{{ url_for('static', filename='images/ranks/' + user.rank + '.png') }}" class="rank-img">
          </h2>
          <form action="{{ url_for('routes.editprofile') }}">
            <input class="btn-edit" type="submit" value="Edit Profile">
          </form>
        </div>
        <br>
        <p>{{ user.bio }}</p>
        <br>
        <p>Posts: {{ num_posts }} Likes: {{ total_likes }} Promotions: {{ user.promote }}</p>
      </div>
    </div>
    <br>
    <div class="select-view">
      <div class="select-buttons">
        <button class="view-button" onclick="openTab(event, 'Posts')" id="defaultOpen">Posts</button>
        <button class="view-button" onclick="openTab(event, 'Purchased')">Purchased</button>
        <button class="view-button" onclick="openTab(event, 'Bounties-Claimed')">Bounties Claimed</button>
        <button class="view-button" onclick="openTab(event, 'Listings')">Listings</button>
      </div>
    </div>
    <br>

    <!-- Tab content -->
    <div id="Posts" class="tabcontent">
      <div class="forum-section">
        <div class="post-container">
          <div class="row">
            {% for item in disc_posts %}
            <div class="col-lg-3 col-md-4 col-sm-6">
              <div class="postbubble">
                <img
                  src="{{ url_for('static', filename='images/posts/' + item.img) }}"
                  alt="Post Image"
                >
                <div class="screen-overlay overlay-animation">
                  <div class="posttext">
                    <div class="postheader">
                      <div class="posttitle">{{ item.title }}</div>
                      <form
                        action="{{ url_for('routes.delete_post', post_id=item.pid, post_flag=item.flag) }}"
                        method="POST"
                      >
                        <input type="hidden" name="_method" value="DELETE">
                        <button type="submit" class="reactbutton">
                          <i class="fa fa-trash fa-lg" aria-hidden="true"></i>
                        </button>
                      </form>
                    </div>
                    <div class="postcontent">{{ item.desc }}</div>
                  </div>
                </div>
              </div>
            </div>
            {% endfor %}
          </div>
        </div>
      </div>
    </div>

    <div id="Purchased" class="tabcontent" style="display:none">
      <h3 style="text-align: center">Purchased Posts~</h3>
      <div class="forum-section">
        <div class="post-container">
          <div class="row">
            {% for item in purchased_items %}
            <div class="col-lg-3 col-md-4 col-sm-6">
              <div class="postbubble">
                <img
                  src="{{ url_for('static', filename='images/sellpics/' + item.img) }}"
                  alt="Post Image"
                >
                <div class="screen-overlay overlay-animation">
                  <div class="posttext">
                    <div class="postheader">
                      <div class="posttitle">{{ item.title }}</div>
                    </div>
                    <div class="postcontent">${{ item.price }}</div>
                    <div class="postcontent"> 
                      {% if item.user.uid != current_user.uid %}
                      <a href="{{ url_for('routes.view_userpf', user_id=item.user.uid) }}"> Sold by {{ item.user.username }}</a>
                      {% else %}
                      <a href="{{ url_for('routes.profile') }}"> Sold by {{ item.user.username }}</a>
                      {% endif %}
                    </div>
                    <div class="postcontent">{{ item.desc }}</div>
                  </div>
                </div>
              </div>
            </div>
            {% endfor %}
          </div>
        </div>
      </div>
    </div>
    
    <div id="Bounties-Claimed" class="tabcontent" style="display:none">
      <h3 style="text-align: center">Bounties Claimed</h3>
      <div class="forum-section">
        <div class="post-container">
          <div class="row">
            {% for item in bounties_claimed %}
            <div class="col-lg-3 col-md-4 col-sm-6">
              <div class="postbubble">
                <img
                  src="{{ url_for('static', filename='images/posts/' + item.img) }}"
                  alt="Post Image"
                >
                <div class="screen-overlay overlay-animation">
                  <div class="posttext">
                    <div class="postheader">
                      <div class="posttitle">{{ item.title }}</div>
                    </div>
                    <div class="postcontent">{{ item.desc }}</div>
                    <div class="postdetails">
                      <p>Price: {{ item.price }}</p>
                      <p>Status: {{ item.status }}</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            {% endfor %}
          </div>
        </div>
      </div>
    </div>
    
    <div id="Listings" class="tabcontent" style="display:none">
      <h3 style="text-align: center">Listings~</h3>
      <div class="forum-section">
        <div class="post-container">
          <div class="row">
            {% for item in sold_items %}
            <div class="col-lg-3 col-md-4 col-sm-6">
              <div class="postbubble">
                {% if item.flag == "Listing"%}
                <img
                  src="{{ url_for('static', filename='images/sellpics/' + item.img) }}"
                  alt="Post Image"
                >
                {% elif item.flag == "Bounty" %}
                <img
                  src="{{ url_for('static', filename='images/posts/' + item.img) }}"
                  alt="Post Image"
                >
                {% endif %}
                <div class="screen-overlay overlay-animation">
                  <div class="posttext">
                    <div class="postheader">
                      <div class="posttitle">{{ item.title }}</div>
                      <form
                        action="{{ url_for('routes.delete_post', post_id=item.sid if item.flag == 'Listing' else item.pid, post_flag=item.flag) }}"
                        method="POST"
                      >
                        <input type="hidden" name="_method" value="DELETE">
                        <button type="submit" class="reactbutton">
                          <i class="fa fa-trash fa-lg" aria-hidden="true"></i>
                        </button>
                      </form>
                    </div>
                    <div class="postcontent">{{ item.desc }}</div>
                    <div class="postdetails">
                      <p>Price: {{ item.price }}</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            {% endfor %}
          </div>
        </div>
      </div>
    </div>
  </div>
  <br>
</div>

<script>
  function openTab(evt, tabName) {
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
      tabcontent[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("view-button");
    for (i = 0; i < tablinks.length; i++) {
      tablinks[i].className = tablinks[i].className.replace(" active", "");
    }
    document.getElementById(tabName).style.display = "block";
    evt.currentTarget.className += " active";
  }

  // Open the default tab
  document.getElementById("defaultOpen").click();
</script>
{% endblock %}
